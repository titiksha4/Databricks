<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=dpiI8CyVsrzWsJLBFKehGpLhv3qFjX7dUn1mYxfCXhI);ol{margin:0;padding:0}table td,table th{padding:0}.c10{border-right-style:solid;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;padding-right:0pt}.c0{background-color:#ffffff;padding-top:18pt;border-bottom-width:0pt;padding-bottom:5.4pt;line-height:1.25;border-bottom-style:solid;orphans:2;widows:2;text-align:left}.c2{color:#1f2328;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Arial";font-style:normal}.c11{color:#1f2328;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:17.5pt;font-family:"Arial";font-style:normal}.c3{background-color:#ffffff;padding-top:0pt;padding-bottom:12pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c8{color:#0f0f0f;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:23pt;font-family:"Roboto";font-style:normal}.c7{color:#1f2328;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:18pt;font-family:"Arial";font-style:normal}.c6{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10.5pt;font-family:"Roboto";font-style:normal}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c5{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c9{background-color:#ffffff;max-width:451.4pt;padding:72pt 72pt 72pt 72pt}.c4{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c9 doc-content"><h1 class="c5 c10" id="h.gaxwqc87hphy"><span class="c8">DATABRICKS x DBT End-To-End Data Engineering Project</span></h1><p class="c5"><span class="c1">Titiksha Jain</span></p><h2 class="c0" id="h.g5ft79szgxya"><span class="c7">Overview</span></h2><p class="c3"><span class="c2">This project demonstrates an end-to-end data ingestion pipeline using Databricks, leveraging Unity Catalog for data governance, Auto Loader for incremental data ingestion, and Databricks Workflows for pipeline automation.</span></p><h2 class="c0" id="h.e1pri82g10zo"><span class="c7">Prerequisites</span></h2><p class="c3"><span class="c2">I created volumes in the Catalog: bronze, silver, gold, raw, and metastore. Using Databricks,I uploaded the following files into the databricks: dim_flights,dim_passengers,dim_airports,fact_bookings in the following rawdata schema</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 245.33px;"><img alt="" src="images/image15.png" style="width: 601.70px; height: 245.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3 c4"><span class="c1"></span></p><h2 class="c0" id="h.jkc87usfdifo"><span class="c7">How I Created Volume &amp; Schema in the Catalog</span></h2><h2 class="c0" id="h.emvv56bws8rh"><span class="c11">Create Databricks resource:</span></h2><p class="c3"><span class="c2">I set up a Databricks workspace notebook called &ldquo;Setup&rdquo;. Created Volume &lsquo;rawvolume&rsquo;. Then created directory &lsquo;rawdata&rsquo; and created new folders &lsquo;flights&rsquo; , &lsquo;airports&rsquo;, &lsquo;bookings&rsquo; and &lsquo;customers&rsquo; and uploaded dim_flights,dim_passengers,dim_airports and fact_bookings in the new folders created under &lsquo;rawdata&rsquo; folder.</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 189.33px;"><img alt="" src="images/image6.png" style="width: 601.70px; height: 189.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2">Create Schema for the Layers:</span></p><p class="c3"><span class="c2">Created schema for bronze, silver and gold. Within these new schemas, created volumes &lsquo;bronzevolume&rsquo;,&rsquo;silvervolume&rsquo; and &lsquo;goldvolume&rsquo; respectively.</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 169.33px;"><img alt="" src="images/image13.png" style="width: 601.70px; height: 169.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 173.33px;"><img alt="" src="images/image1.png" style="width: 601.70px; height: 173.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2">Created dynamic parameter to read the files</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 232.00px;"><img alt="" src="images/image8.png" style="width: 601.70px; height: 232.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">Using the parameter, we read the csv files in the bronze, silver and gold layers. Also added checkpoint location in the volume folder.</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 228.00px;"><img alt="" src="images/image11.png" style="width: 601.70px; height: 228.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c2">Created another workspace as &lsquo;SrcParameters&rsquo;</span></p><p class="c3"><span class="c1">Created an array which will be used as an input in another notebook. Then created a dictionary that use that array</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 170.67px;"><img alt="" src="images/image12.png" style="width: 601.70px; height: 170.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c1">Created pipeline under workflows.</span></p><p class="c3"><span class="c1">Put the Task Name: Parameter</span></p><p class="c3"><span class="c1">Path: put the path of the srcparameter notebook</span></p><p class="c3 c4"><span class="c1"></span></p><p class="c3"><span class="c1">Compute: Severless</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 290.67px;"><img alt="" src="images/image9.png" style="width: 601.70px; height: 290.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c1">Then add task:</span></p><p class="c3"><span class="c1">Task Name: IncrementalIngestion</span></p><p class="c3"><span class="c1">Path: put the path of BronzeLayer notebook</span></p><p class="c3"><span class="c1">Depends On: Parameters</span></p><p class="c3"><span class="c1">Add parameters: </span></p><p class="c3"><span class="c1">Key = Src</span></p><p class="c3"><span class="c1">Value = {{input.src}} (added after the loop is done)</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 294.67px;"><img alt="" src="images/image5.png" style="width: 601.70px; height: 294.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c1">Make a loop for this task =&gt; Put Input: {{tasks.Parameters.values.output_key}}</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 278.67px;"><img alt="" src="images/image7.png" style="width: 601.70px; height: 278.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c1">Then run the pipeline</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 273.33px;"><img alt="" src="images/image14.png" style="width: 601.70px; height: 273.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c1">Create new notebook &lsquo;SilverNotebook&rsquo;</span></p><p class="c3"><span class="c1">After running the select query to see the data in the bronzelayer.</span></p><p class="c3"><span class="c1">We try to transformation in the silver layer using DLT</span></p><p class="c3"><span class="c1">We will create rules using dictionary</span></p><p class="c3 c4"><span class="c1"></span></p><p class="c3"><span class="c1">Create a pipeline using a single transformation and in workspace option select silver schema</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 258.67px;"><img alt="" src="images/image4.png" style="width: 601.70px; height: 258.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c1">Name it as &lsquo;DLT_Bookings_Silver&rsquo;</span></p><p class="c3"><span class="c1">Under the pipeline assets, a transformations folder will be created and an empty python file my_transformation has been created. In the python file add the transformation logic and rules required</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 352.00px;"><img alt="" src="images/image3.png" style="width: 601.70px; height: 352.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c1">After the changes we get the end-to-end silver layer pipeline</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 277.33px;"><img alt="" src="images/image2.png" style="width: 601.70px; height: 277.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3"><span class="c1">Now will start preparing the Gold layer</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 314.67px;"><img alt="" src="images/image10.png" style="width: 601.70px; height: 314.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c3 c4"><span class="c6"></span></p><p class="c3 c4"><span class="c1"></span></p></body></html>